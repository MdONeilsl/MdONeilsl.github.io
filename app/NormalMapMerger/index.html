<!--
/*
    Normal Map Merger: A tool for merging two normal maps.
    Copyright (C) 2025  MdONeil 

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>.

    secondlife:///app/agent/ae929a12-297c-45be-9748-562ee17e937e/about
*/
-->

<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Normal Map Merger</title>
    <meta name="description"
        content="Merge normal maps for Second Life content creation.  Combine surface details and effects for advanced lighting in Second Life.">
    <meta name="keywords"
        content="normal map, Second Life tool, 3D texture, texture merging, virtual world, content creation, ALM, Advanced Light Model">
    <meta name="author" content="MdONeil">

    <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "SoftwareApplication",
        "name": "Normal Map Merger",
        "operatingSystem": "Web",
        "applicationCategory": "Graphics Application",
        "featureList": ["Normal Map Merging", "Texture Processing", "Image Manipulation"],
        "description": "A tool for merging two normal maps, blending their alpha channels for per-pixel specular exponent values.  Useful for Second Life content creators.",
        "author": {
            "@type": "Person",
            "name": "MdONeil",
            "url": "secondlife:///app/agent/ae929a12-297c-45be-9748-562ee17e937e/about"
        },
        "url": "https://mdoneilsl.github.io/app/NormalMapMerger/",
        "license": "https://www.gnu.org/licenses/gpl-3.0.html",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        }
    }
    </script>
</head>

<body>
    <link rel=stylesheet href=./css/style.css>
    <div class="container">
        <h2>Normal Map Merger</h2>
        <div class="input-row">
            <div class="dropzone" id="baseDropzone" title="Base Normal Map (e.g., fabric)">
                <input type="file" id="baseInput" accept="image/*" hidden>
            </div>
            <div class="dropzone" id="addDropzone" title="Add Normal Map (e.g., wrinkles)">
                <input type="file" id="addInput" accept="image/*" hidden>
            </div>
            <div class="dropzone" id="maskDropzone"
                title="Control the add input intensity by pixel with a rgb grayscale mask">
                <input type="file" id="maskInput" accept="image/*" hidden>
            </div>
        </div>
        <div class="input-row">
            <label for="intensity">Intensity:</label>
            <input type="range" id="intensity" min="0" max="1" step="0.01" value="1">
        </div>
        <div class="input-row">
            <label for="fallbackAlpha">Fallback Alpha (if inputs lack alpha):</label>
            <input type="range" id="fallbackAlpha" min="0" max="255" step="1" value="255">
        </div>
        <button id="process-btn">Merge Normal Maps</button>
        <div id="error-message" class="error-message"></div>
        <canvas id="preview" class="preview"></canvas>
        <button id="download">Download Result</button>
        <div id="info">
            <p>This tool merges two normal maps using 3D vector rotation mathematics to properly combine surface
                details.
                The base normal map defines the primary surface orientation, while the add normal map overlays secondary
                details like wrinkles, scratches, or patterns.</p>
            <p>The mask image controls the intensity per-pixel: black (0) removes the effect, white (255) applies full
                effect.
                If no mask is uploaded, the Intensity slider uniformly controls the blend strength across the entire
                image.</p>
            <p>Examples: Combine "brick details" with "wall texture" for buildings, or "wrinkles" with "fabric".</p>
            <p>The alpha channel is blended for per-pixel specular exponent values (brighter = shinier).
                Ensure the Advanced Lighting Model is enabled to see effects. Use OpenGL (Y+) for compatibility.</p>
            <p>Note: Per-pixel specular exponent is experimental and may not work as expected in some systems.
                Consider PBR Materials for modern projects.</p>
        </div>
    </div>
    <footer>
        <p>Developed by MdONeil under the <a href="https://www.gnu.org/licenses/gpl-3.0.html">GNU v3 License</a>.
            Contact: <a href="secondlife:///app/agent/ae929a12-297c-45be-9748-562ee17e937e/about">MdONeil</a></p>
        <p>Second Life and SL are trademarks of Linden Research, Inc. This tool is not affiliated with or sponsored by
            Linden Research.</p>
    </footer>

    <script type="module" src="./js/main.js"></script>
</body>

</html>